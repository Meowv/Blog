---
title: 2021.12.31 - å°è®¡
author: é˜¿æ˜Ÿğ‘·ğ’ğ’–ğ’”
date: 2021-12-31
categories: Summary
tags:
  - æ€»ç»“
---

æ˜å¤©å°±æ˜¯å…ƒæ—¦äº†ï¼Œæ–°çš„ä¸€å¹´å³å°†æ¥ä¸´ã€‚

æœ€è¿‘éƒ½åœ¨æäº§å“æ€§èƒ½ä¼˜åŒ–ï¼Œè¿˜äº†å¥½å¤šæŠ€æœ¯å€ºåŠ¡ã€‚

äº§å“çš„è¡¨å•æœ‰ä¸€ä¸ªç»„ç»‡é¡¹ç›®ç­›é€‰é¡¹ï¼Œç”¨çš„æ˜¯å»ºæ¨¡çš„è‡ªå®šä¹‰å¤šçº§ä¸‹æ‹‰æ¡†ï¼Œå®ƒä¼šæŠŠé›†å›¢ã€åŒºåŸŸã€å…¬å¸ã€é¡¹ç›®æŒ‰ç…§å±‚çº§ç»“æ„å±•ç¤ºå‡ºæ¥ï¼Œæœ¬æ¥ä¸€åˆ‡éƒ½å¾ˆå®Œç¾ï¼Œä½†æ˜¯å½“æ•°æ®é‡åˆ°è¾¾ä¸€å®šçº§åˆ«åï¼Œä¸‹æ‹‰æ¡†å¡æ­»ï¼Œé¡µé¢æŒ‚æ‰äº†ã€‚äºæ˜¯å°±æ¥æ´»äº†ï¼Œæˆ‘è¦è´Ÿè´£å°†ç»„ç»‡ä¸‹æ‹‰æ¡†è¿™å—æ€§èƒ½é—®é¢˜æå®šã€‚å’±ä»¬å»ºæ¨¡å†…ç½®çš„ä¸€ä¸ªæ ‡å‡†æ§ä»¶ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ç­›é€‰é¡¹ï¼Œåšè¿‡å¤§é‡ä¼˜åŒ–ï¼Œæ”¯æŒæ•°æ®æ‡’åŠ è½½ã€‚ä½†æ˜¯è‡ªå®šä¹‰çš„å¤šçº§ä¸‹æ‹‰æ¡†å•¥éƒ½ä¸æ”¯æŒã€‚

æŠŠçªç ´ç‚¹æ”¾åˆ°æ ‡å‡†çš„ç­›é€‰é¡¹æ§ä»¶ä¸Šï¼Œè®©å»ºæ¨¡å¯¹å¤–æä¾›è¿™ä¸ªç»„ä»¶ï¼Œç„¶åç”±å†³ç­–å¹³å°è¿›è¡Œä¸€å±‚ç®€å•çš„å°è£…ï¼Œäº§å“è¿™è¾¹æä¾›æ•°æ®æºã€‚æ¨¡æ‹Ÿæ ‡å‡†æ§ä»¶çš„åŠŸèƒ½è§£å†³è¿™ä¸ªè¯¥æ­»çš„æ€§èƒ½é—®é¢˜ã€‚

çœ‹çœ‹å»ºæ¨¡å¹³å°ä¸šåŠ¡ç»„ä»¶,ä»–æœ‰ä¸€äº›å±æ€§åŠäº‹ä»¶å¯ä»¥è°ƒç”¨ã€‚

```html
<title>åŸºç¡€ç”¨æ³•</title>
<describe>é¡¹ç›®æ§ä»¶çš„åŸºç¡€ç”¨æ³•</describe>
<template>
  <hc-project-select
    source="æ ‡å‡†é¡¹ç›®è¿‡æ»¤"
    filter-type="LeafProject,LeafCompany"
    display-type="Company,Project"
    @change="change"
  ></hc-project-select>
</template>
<script>
  export default {
    data: function () {
      return {};
    },
    methods: {
      change(e) {
        console.log(e);
      },
    },
  };
</script>
```

è¿›è¡Œç®€å•çš„å°è£…ï¼š

```html
<div class="project-select-main" v-if="isPropsValidator">
  <hc-project-select
    class="private-project-select"
    :display-type="displayType"
    :filter-type="filterType"
    @change="change"
    :source="source"
    ref="projectSelect"
  ></hc-project-select>
</div>
```

```js
module.exports = {
  props: {
    source: String,
    filterTypeList: Array,
    displayTypeList: Array,
    elementCode: String,
  },
  data: function () {
    return {
      isPropsValidator: true,
      value: "",
    };
  },
  computed: {
    filterType: function () {
      var me = this;
      return me.filterTypeList.join(",");
    },
    displayType: function () {
      var me = this;
      return me.displayTypeList.join(",");
    },
  },
  created: function () {
    this._propsValidator();
  },
  mounted: function () {},
  methods: {
    change: function (item) {
      if (!this.value) {
        this.value = item;
        this.$emit("mounted", item);
      } else {
        this.value = item;
        this.$emit("changed", item);
      }
    },
    setValue: function (value) {
      this.$refs.projectSelect.setValue(value);
    },
    getValue: function () {
      return this.value;
    },
    getText: function () {
      return this.$refs.projectSelect.getText();
    },
    getElementCode: function () {
      if (
        this.elementCode &&
        this.value &&
        this.value.item &&
        this.value.item.extData &&
        this.value.item.extData[this.elementCode]
      ) {
        return this.value.item.extData[this.elementCode];
      } else {
        return "";
      }
    },
    _propsValidator: function () {
      if (!this.filterType || !this.displayType) {
        this.isPropsValidator = false;
        $notify.warning("ç»„ä»¶é…ç½®é”™è¯¯ï¼Œè¯·é‡æ–°é…ç½®ã€‚");
      } else {
        this.isPropsValidator = true;
      }
    },
  },
};
```

è‡ªå®šä¹‰æ•°æ®æºæ˜¯ä¸ªéš¾ç‚¹ï¼Œåˆšå¼€å§‹å‡ åä¸‡æ•°æ®æºæ„å»ºæ¯æ¬¡è€—æ—¶éƒ½æœ‰ 30~40 ç§’å·¦å³ï¼Œç»è¿‡ä¼˜åŒ–ä»£ç ï¼Œç°åœ¨é¦–æ¬¡æ‰“å¼€åœ¨ä¸€ç§’å·¦å³å®Œæˆï¼Œç„¶åç¼“å­˜æ•°æ®ï¼Œåç»­æ‰“å¼€æ¯«ç§’çº§åˆ«å®Œæˆï¼Œå®Œç¾è§£å†³äº†ç»„ç»‡é¡¹ç›®ç­›é€‰é¡¹å¡é¡¿çš„é—®é¢˜ã€‚

```csharp
private List<OptionItem> GetProjectsTree(List<OrganizationDTO> organizations)
{
    var items = new List<OptionItem>();
    var projects = _dataFilterAppService.Instance.GetProjectList();
    var dics = projects.GroupBy(x => x.BuGuid).ToDictionary(x => x.Key, x => x.ToList());
    foreach (var org in organizations)
    {
        var parentItem = new OptionItem
        {
            Text = org.BuName,
            Parent = org.ParentGuid.HasValue ? org.ParentGuid.Value.ToString() : string.Empty,
            Value = org.Buguid.ToString(),
            IsLeaf = false,
            ExtData = new Dictionary<string, object>
            {
                { "BUType", org.BuType },
                { "BUGUID", org.Buguid.ToString() },
                { "BUName", org.BuName },
                { "IsHasStage", org.IsEndCompany ? 0 : 1 },
                { "HierarchyCode", org.HierarchyCode },
                { "OrderHierarchyCode", org.OrderHierarchyCode }
            }
        };
        if (org.IsEndCompany)
        {
            parentItem.ExtData["IsEndCompany"] = true;
        }
        items.Add(parentItem);
        if (org.IsEndCompany)
        {
            var hasValue = dics.TryGetValue(org.Buguid, out List<ProjectMngDto> _projects);
            if (hasValue)
            {
                items.AddRange(_projects.Select(x => new OptionItem
                {
                    Text = x.ProjectName,
                    Value = x.ProjectGUID.ToString(),
                    Parent = org.Buguid.ToString(),
                    IsLeaf = true,
                    ExtData = new Dictionary<string, object>
                    {
                        { "BUType", 3 },
                        { "BUGUID", org.Buguid.ToString() },
                        { "BUName", org.BuName },
                        { "IsHasStage", org.IsEndCompany ? 0 : 1 },
                        { "HierarchyCode", x.HierarchyCode },
                        { "OrderHierarchyCode", org.OrderHierarchyCode }
                    }
                }));
            }
            else
            {
                items.Remove(parentItem);
            }
        }
    }
    var removeList = new List<string>();
    var list = items.Where(x => !x.IsLeaf).ToList();
    foreach (var item in list)
    {
        if (!items.Any(x => x.Parent == item.Value))
        {
            removeList.Add(item.Value);
        }
    }
    items = items.Where(x => !removeList.Contains(x.Value)).ToList();
    return items;
}
```

è¿™æ˜¯è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè¿˜ä¸»è´£äº†é¡¹ç›®åœ°å›¾çš„åŠ è½½ä¼˜åŒ–æ–¹æ¡ˆï¼Œäº§å“è°ƒç”¨äº†ç™¾åº¦åœ°å›¾ï¼Œéœ€è¦åœ¨ç™¾åº¦åœ°å›¾ä¸Šé¢è¿›è¡Œåœ°å—ä½ç½®æ ‡ç‚¹æ“ä½œï¼Œä½†æ˜¯å½“æµ·é‡æ ‡ç‚¹è¾¾åˆ°ä¸Šä¸‡çº§åˆ«ï¼Œåœ°å›¾å°±ä¼šå¡æ­»...

ä¹‹å‰çš„æ–¹æ¡ˆæ˜¯æ ¹æ®ç­›é€‰æ¡ä»¶æŸ¥å‡ºæ‰€æœ‰åœ°å—ä½ç½®åŠå…¶åœ°å—çš„ç›¸å…³ä¿¡æ¯ï¼Œå½“ç­›é€‰æ¡ä»¶å…¨éƒ¨å‘½ä¸­æ—¶ï¼Œä¼šæŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼Œè¿›è¡Œè‡ªå®šä¹‰æ ‡ç‚¹æ“ä½œã€‚è¿™å½“ç„¶ä¼šå¡ï¼Œä¸å¡æ‰æ€ªã€‚

ç°åœ¨çš„æ–¹æ¡ˆï¼Œæ ¹æ®ç­›é€‰æ¡ä»¶æŸ¥å‡ºæ‰€æœ‰æ•°æ®æŒ‰çœä»½çš„æ±‡æ€»æ•°æ®ï¼Œé¦–æ¬¡åŠ è½½é¡µé¢åªå±•ç¤ºçœä»½å’Œçœä»½ä¸‹å¯¹åº”åœ°å—æ•°é‡ï¼Œè¿™æ ·é¦–æ¬¡åŠ è½½å°±éå¸¸çš„å¿«ï¼Œä¸ä¼šæœ‰ä»»ä½•æ€§èƒ½é—®é¢˜ã€‚å½“ç‚¹å‡»çœä»½çš„æ—¶å€™å†å»è°ƒç”¨æ¥å£æŸ¥è¯¢çœä»½ä¸‹å¯¹åº”çš„åœ°å—ä½ç½®ï¼Œæ‹¿åˆ°åœ°å—ä½ç½®å’Œç›¸å…³æ•°æ®åå†è¿›è¡Œæœ€åçš„æ ‡ç‚¹æ“ä½œã€‚

è¿˜æœ‰ä¸€äº›é›¶é›¶æ•£æ•£çš„å„ç§ä¼˜åŒ–ï¼Œæ‹¿åœ°æµ‹ç®—äº§å“ç¬¬ä¸€æ¬¡è¿›å…¥ä¸»é¡¹å‘ç‰ˆï¼Œåé¢ä¼šè¿›å®‰è£…ç›˜ã€‚2021 äº§å“å–å¾—è²Œä¼¼å¹¶ä¸æ€ä¹ˆå¥½ï¼Œæ²¡æœ‰å‡ ä¸ªå®¢æˆ·ï¼Œæ•´ä¸ªæˆ¿åœ°äº§è¡Œä¸šéƒ½å¤„äºä½è¿·çŠ¶æ€ã€‚2022 æ¥äº†ï¼Œä»–èƒ½æ´»è¿‡æ¥å—ï¼Ÿèµ¶ç´§å¹´åº•çš„ OKR å¦¥å¦¥çš„å‡‰äº†ï¼Œå…¥èŒä¸åˆ°ä¸€å¹´ï¼Œå¹´ç»ˆä¹Ÿä¸çŸ¥é“èƒ½æ‹¿å¤šå°‘ã€‚

ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ—¢æ¥ä¹‹åˆ™å®‰ä¹‹ï¼ŒæŠŠæ‰‹å¤´ä¸Šçš„æ¯ä»¶äº‹éƒ½åšå¥½å°±è¡Œäº†ï¼Œ2022ï¼Œå¸Œæœ›ä¸€åˆ‡éƒ½å¥½ã€‚åŠ æ²¹ï¼
